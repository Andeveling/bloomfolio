---
import { getCollection } from "astro:content";
import BlogCard from "./BlogCard.astro";
import { ArrowRight } from "@lucide/astro";

const blogEntries = await getCollection("blog");

// Sort by publish date, most recent first
const sortedPosts = blogEntries.sort(
  (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime()
);

// Get only the latest 3 posts
const latestPosts = sortedPosts.slice(0, 3);
---

<section id="blog" class="relative py-32 px-6 overflow-hidden">
  <!-- Subtle gradient background -->
  <div class="absolute inset-0 bg-gradient-to-b from-base-100 via-base-200/50 to-base-100 -z-10"></div>
  
  <div class="max-w-7xl mx-auto">
    <!-- Section Header -->
    <div class="text-center mb-20 max-w-3xl mx-auto">
      <h2 class="text-5xl md:text-6xl font-bold mb-6 tracking-tight bg-gradient-to-r from-base-content to-base-content/70 bg-clip-text text-transparent">
        Últimas Publicaciones
      </h2>
      <p class="text-xl md:text-2xl text-base-content/60 font-light leading-relaxed">
        Reflexiones, conocimientos y tutoriales sobre desarrollo web, diseño y tecnología.
      </p>
    </div>

    <!-- Blog Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
      {latestPosts.map((post, index) => (
        <div 
          class="blog-card-wrapper"
          style={`animation-delay: ${index * 0.1}s`}
        >
          <BlogCard post={post} />
        </div>
      ))}
    </div>

    <!-- CTA Button -->
    <div class="text-center">
      <a 
        href="/blog" 
        class="inline-flex items-center gap-3 px-8 py-4 text-base font-medium text-base-100 bg-primary hover:bg-primary-focus rounded-2xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-xl"
      >
        Ver todas las publicaciones
        <ArrowRight class="size-5" />
      </a>
    </div>
  </div>
</section>

<style>
  @keyframes fade-in-scale {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .blog-card-wrapper {
    animation: fade-in-scale 0.6s ease-out forwards;
    opacity: 0;
  }
</style>
